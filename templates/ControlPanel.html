<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Automated Greenhouse Control Panel</title>

        <script src="https://d3js.org/d3.v6.min.js"></script>
        {% load static %}
        <link rel="stylesheet" href="{% static 'css/style.css' %}" type="text/css">
        <script src="{% static 'js/chart.js' %}"></script>
        
    </head>
<body>

    <div class="title">
        <h1>Automated Greenhouse Control Panel</h1>
    </div>

    <div class="camera">
        <div class="subtitle">
            <h2>Camera</h2>
        </div>
        <img src='http://192.168.191.57:8000/video_feed/'>
    </div>

    <div class="data">

        <div class="subtitle">
            <h2>The latest data collected</h2>
        </div>        

        <div class="data_show">
            <p> Time: {{ data_dic.time }}</p> 

            <p> Temperature: {{ data_dic.sensor_temperature_inside }}</p>

            <p> Humidity: {{ data_dic.sensor_humidity_inside }}</p>
            <p> Temperature indoor: {{ data_dic.sensor_temperature_outside }}</p>
            <p> Humidity indoor: {{ data_dic.sensor_humidity_outside }}</p>
            <p> Light level: {{ data_dic.sensor_light}}</p>
            <p> CO2 level: {{ data_dic.sensor_CO2}}</p>
            <p> Moisture level: {{data_dic.sensor_moisture}}</p>
            
            <p> Light state: {{data_dic.light}}</p>
            <p> Water pump state: {{data_dic.waterpump}}</p>
            <p> Fan0 state: {{data_dic.fan0}}</p>
            <p> Fan1 state: {{data_dic.fan1}}</p>
            <p> Humidifier state: {{data_dic.humidifier}}</p>
            <p> Heater state: {{data_dic.heater}}</p>
        </div> 

        <div class="subtitle">
            <h2>Data visualization</h2>
        </div> 
        <Temperature></Temperature>
        <Humidity></Humidity>
        <Light></Light>
        <CO2></CO2>
        <Moisture0></Moisture0>
        <Moisture1></Moisture1>
        <Moisture2></Moisture2>
        <Moisture3></Moisture3>
    </div>




    <div class="control">
        <div class="subtitle">
            <h2>System Control</h2>
        </div>
        <form action="" method="POST">
            {% csrf_token %}
            <button class="button" type="submit" name="button_light_on" >Turn on Light</button>
        </form>
        <form action="" method="POST">
            {% csrf_token %}
            <button class="button" type="submit" name="button_light_off" >Turn off Light</button>
        </form>
        <form action="" method="POST">
            {% csrf_token %}
            <button class="button" type="submit" name="button_fan0_on" >Turn on Fan0</button>
        </form>
        <form action="" method="POST">
            {% csrf_token %}
            <button class="button" type="submit" name="button_fan0_off" >Turn off Fan0</button>
        </form>
        <form action="" method="POST">
            {% csrf_token %}
            <button class="button" type="submit" name="button_fan1_on" >Turn on Fan1</button>
        </form>
        <form action="" method="POST">
            {% csrf_token %}
            <button class="button" type="submit" name="button_fan1_off" >Turn off Fan1</button>
        </form>
        <form action="" method="POST">
            {% csrf_token %}
            <button class="button" type="submit" name="button_waterpump_on" >Turn on Water Pump for 10s</button>
        </form>
        <form action="" method="POST">
            {% csrf_token %}
            <button class="button" type="submit" name="button_humidifier_on_strong" >Increase the humidity greatly for 30min</button>
        </form>
        <form action="" method="POST">
            {% csrf_token %}
            <button class="button" type="submit" name="button_humidifier_on_weak" >Increase the humidity slightly for 30min</button>
        </form>
        <form action="" method="POST">
            {% csrf_token %}
            <button class="button" type="submit" name="button_humidifier_off" >Turn off the humidifier for 30min</button>
        </form>
        <form action="" method="POST">
            {% csrf_token %}
            <button class="button" type="submit" name="button_heater_on_strong" >Increase the temperature greatly for 30min</button>
        </form>
        <form action="" method="POST">
            {% csrf_token %}
            <button class="button" type="submit" name="button_heater_on_weak" >Increase the temperature slightly for 30min</button>
        </form>
        <form action="" method="POST">
            {% csrf_token %}
            <button class="button" type="submit" name="button_heater_off" >Turn off the heater for 30min</button>
        </form>

        {% comment %} Add buttons like the following: {% endcomment %}
        {% comment %} <form action="" method="POST">
            {% csrf_token %}
            <button class="button" type="submit" name = "button_light_on">Turn on light</button>
        </form>   {% endcomment %}

    </div>




    <script type="text/javascript">

        appendGraph("Temperature", {{visualization_data_dic.temperature_24h}});
        appendGraph("Humidity", {{visualization_data_dic.humidity_24h}})
        appendGraph("Light", {{visualization_data_dic.light_24h}})
        appendGraph("CO2", {{visualization_data_dic.CO2_24h}})
        appendGraph("Moisture0", {{visualization_data_dic.moisture_24h_0}})
        appendGraph("Moisture1", {{visualization_data_dic.moisture_24h_1}})
        appendGraph("Moisture2", {{visualization_data_dic.moisture_24h_2}})
        appendGraph("Moisture3", {{visualization_data_dic.moisture_24h_3}})

    </script> 


</body>
</html>